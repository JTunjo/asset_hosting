<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Registro a Lista de Espera</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  font-family: system-ui, sans-serif;
  background: linear-gradient(180deg,#f9fafb,#eef2ff);
  margin:0;
}
.hidden{display:none !important;}

header{
  background:#2563eb;
  color:white;
  text-align:center;
  padding:1rem;
  position:fixed;
  top:0;
  width:100%;
}

.main{
  margin-top:130px;
  margin-bottom:80px;
  display:flex;
  justify-content:center;
}

.card{
  background:white;
  padding:2rem;
  border-radius:16px;
  width:100%;
  max-width:520px;
  box-shadow:0 20px 40px rgba(0,0,0,.08);
}

input,textarea{
  width:100%;
  padding:.6rem;
  margin-top:.5rem;
  border-radius:10px;
  border:1px solid #e5e7eb;
}

button{
  margin-top:1.4rem;
  width:100%;
  padding:.7rem;
  border-radius:12px;
  border:none;
  background:#2563eb;
  color:white;
  font-weight:600;
  cursor:pointer;
}

/* SUCCESS OVERLAY — NEVER VISIBLE ON LOAD */
#success-overlay{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(255,255,255,.8);
  backdrop-filter:blur(4px);
  align-items:center;
  justify-content:center;
  z-index:100;
}

.check{
  width:90px;
  height:90px;
  background:#2563eb;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  animation:pop .3s ease-out;
}

.check svg{
  width:48px;
  height:48px;
  fill:none;
  stroke:white;
  stroke-width:5;
  stroke-linecap:round;
  stroke-linejoin:round;
  stroke-dasharray:50;
  stroke-dashoffset:50;
  animation:draw .4s ease-out forwards .2s;
}

@keyframes draw{to{stroke-dashoffset:0}}
@keyframes pop{from{transform:scale(.6);opacity:0}to{transform:scale(1);opacity:1}}

/* LOADING OVERLAY */
#loading-overlay{
  position:fixed;
  inset:0;
  background:rgba(255,255,255,.85);
  backdrop-filter:blur(3px);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:90;
}

.spinner{
  width:56px;
  height:56px;
  border:5px solid #e5e7eb;
  border-top-color:#2563eb;
  border-radius:50%;
  animation:spin 0.8s linear infinite;
}

@keyframes spin{
  to{transform:rotate(360deg)}
}
</style>
</head>

<body>

<header>
  <img src="tunjoh.png" height="40">
  <h2>Registro a Lista de Espera</h2>
</header>

<div class="main">
<div class="card">

<div class="page" data-q="q1">
<h3>Nombre de la Organización</h3>
<input name="q1" placeholder="Escriba su respuesta aquí">
<button onclick="next()">Siguiente</button>
</div>

<div class="page hidden" data-q="q2">
<h3>Nombre del Proyecto</h3>
<textarea name="q2" placeholder="Escriba su respuesta aquí"></textarea>
<button onclick="next()">Siguiente</button>
</div>

<div class="page hidden" data-q="q3">
<h3>Email</h3>
<input email="q3">
<button onclick="next()">Siguiente</button>
</div>

<div class="page hidden" data-q="q4">
<h3>Teléfono</h3>
<input name="q4">
<button onclick="next()">Siguiente</button>
</div>

<div class="page hidden" data-q="q5">
<h3>¿Qué valor espera obtener de la aplicación?</h3>
<textarea name="q5" placeholder="Escriba su respuesta aquí"></textarea>
<button onclick="next()">Siguiente</button>
</div>

<div class="page hidden" data-q="q6">
<h3>¿Por qué medio tuvo conocimiento de la aplicación?</h3>
<textarea name="q6" placeholder="Redes Sociales, Evento, Publicación, etc."></textarea>
<button onclick="submitSurvey()">Enviar</button>
</div>

<div class="page hidden" id="thanks">
<h2>¡Gracias por participar!</h2>
<p>Tu respuesta ha sido registrada.</p>
</div>

</div>
</div>

<!-- LOADING OVERLAY -->
<div id="loading-overlay" class="hidden">
  <div class="spinner"></div>
</div>


<!-- SUCCESS OVERLAY -->
<div id="success-overlay">
  <div class="check">
    <svg viewBox="0 0 52 52">
      <path d="M14 27 L23 36 L38 18"/>
    </svg>
  </div>
</div>

<script>
const endpoint="https://script.google.com/macros/s/AKfycbywXF69-sKQ7NBi8kXkYNDlq1m68Ov5ICx2HC16Z7rwW9BFlXN89__p_CQcIxBWlc4sRg/exec";
const pages=[...document.querySelectorAll(".page:not(#thanks)")];
let idx=0;

function show(){
  pages.forEach((p,i)=>p.classList.toggle("hidden",i!==idx));
}
show();

function next(){
  idx++;
  show();
}

function collect(){
  const data={};
  pages.forEach(p=>{
    const k=p.dataset.q;
    if(!k)return;
    data[k]=p.querySelector("input,textarea").value.trim();
  });
  return data;
}

async function submitSurvey(){
  const data=collect();

  const qs=Object.entries(data)
    .map(([k,v])=>`${encodeURIComponent(k)}=${encodeURIComponent(v)}`)
    .join("&");

  const loading=document.getElementById("loading-overlay");
  const success=document.getElementById("success-overlay");

  // 1️⃣ SHOW LOADING IMMEDIATELY
  loading.classList.remove("hidden");

  // 2️⃣ SEND DATA
  await fetch(endpoint + "?" + qs, { method:"GET" });

  // 3️⃣ SWITCH TO SUCCESS ANIMATION
  loading.classList.add("hidden");
  success.style.display="flex";

  // 4️⃣ FINAL THANK YOU
  setTimeout(()=>{
    success.style.display="none";
    pages.forEach(p=>p.classList.add("hidden"));
    document.getElementById("thanks").classList.remove("hidden");
  },800);
}
</script>

</body>
</html>
